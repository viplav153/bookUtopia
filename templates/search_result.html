
    
{% extends 'base.html' %}
{% block content %}


<!-- <link rel="stylesheet" href="/static/style.css"> -->
<div>
    
     
    {% for item in results["results"] %}
   
    <p><img src="{{item.book_cover}}" /></p>
    <p>Title:<i>{{ item.title }}</i></p>
    <p>Author: {{ item.author[2:-2] }}</p>
    <p>ISBN: {{ item.ISBN }}</p>

    {% endfor %}

</div>

<style type="text/css">
  html, body { height: 100%; margin: 0; padding: 0; }
  #map { height: 100%; }
</style>

<body>
<div id="map"></div>

<script type="text/javascript">
  const books = ({{ results | tojson }});
  zipcode = books.results[0].zipcode.toString();





  function initMap() {
   // var getLatLngByZipcode = function(zipcode) {

    
    var geocoder = new google.maps.Geocoder();
    // var address = {zipcode};
    geocoder.geocode({ 'address': zipcode }, function (results, status) {
        console.log('status:');
        console.log(status);
        if (status === google.maps.GeocoderStatus.OK) {
          console.log('status is ok');


            var latitude = results[0].geometry.location.lat();
            var longitude = results[0].geometry.location.lng();
            const sfBayCoords = { lat: latitude , lng: longitude };
            const map = new google.maps.Map(document.getElementById('map'), {
              center: sfBayCoords,
              zoom: 8
            });
            const sfMarker = addMarker('static/imgs/marker.png', sfBayCoords, 'SF Bay', map);
            sfMarker.addListener('click', () => alert('Hello!'));
              // Loop over hackbrightLocations to make lots of markers
            const markers = [];
            books.results.forEach(book => {
              console.log('book');
              console.log(book);

              book.coords = {lat : latitude, lng: longitude}

              markers.push(addMarker('static/imgs/marker.png', book.coords , book.title, map));
            })
            console.log('books.results');
            console.log(books.results);
            for (let book of books.results) {
              console.log('book');
              console.log(book)
                
            }
              // Loop over markers list to attach click handlers
            for (let marker of markers) {
              const aboutLocation = `<h1>BookLot - ${books.results[0].title}</h1>
                  <p>Located at</p>
                  <ul>
                    <li><b>Lat:</b> ${marker.position.lat()}</li>
                    <li><b>Lng:</b> ${marker.position.lng()}</li>
                  </ul>
                  `;
              addInfoWindowToMarker(aboutLocation, marker, map);
            }
          alert ("Latitude: " + latitude + "\nLongitude: " + longitude);
            
        } else {
            alert("Request failed.")
        }
    });
  //};
  // console.log("getLatLngByZipcode")
  // console.log(getLatLngByZipcode("Sydney, NSW"))

  // console.log('lat:');
  // console.log(latitude);
  // console.log('long:');
  // console.log('longitude');
  // const sfBayCoords = { lat: latitude , lng: longitude };
  // const map = new google.maps.Map(document.getElementById('map'), {
  //   center: sfBayCoords,
  //   zoom: 8
  // });
  // const sfMarker = addMarker('static/imgs/marker.png', sfBayCoords, 'SF Bay', map);
  // sfMarker.addListener('click', () => alert('Hello!'));
  // Loop over hackbrightLocations to make lots of markers
  // const markers = [];
  // for (let book of books.results) {
  //   console.log(book)
    
    // markers.push(addMarker('static/imgs/marker.png', hbLocation.coords, hbLocation.name, map));
  // }
  // Loop over markers list to attach click handlers
  // for (let marker of markers) {
  //   const aboutLocation = `<h1>BookLot - ${books.results[0].title}</h1>
  //     <p>Located at</p>
  //     <ul>
  //       <li><b>Lat:</b> ${marker.position.lat()}</li>
  //       <li><b>Lng:</b> ${marker.position.lng()}</li>
  //     </ul>
  //     `;
  //   addInfoWindowToMarker(aboutLocation, marker, map);
  // }
  //getLatLngByZipcode(zipcode);
}
/**
 * Utility/helper functions
 */
function addMarker(icon, position, title, map) {
  const marker = new google.maps.Marker({ position, map, title, icon });
  return marker;
}
function addInfoWindowToMarker(content, marker, map) {
  console.log('in 124');
  const infoWindow = new google.maps.InfoWindow({
    content,
    maxWidth: 200
  });
  marker.addListener('click', () => infoWindow.open(map, marker));
}
</script>


<script async defer src={{script_url}}></script>
</body>


        
{% endblock %} 


